"use strict";(self.webpackChunkpalettea_web=self.webpackChunkpalettea_web||[]).push([[195],{195:(vt,D,u)=>{u.r(D),u.d(D,{ColorPickerPageRoutes:()=>pt});var n=u(946),c=u(814);const ce=["*"],ue=["palette"];function de(e,o){if(1&e&&(n.TgZ(0,"th"),n._uU(1),n.qZA()),2&e){const t=o.$implicit,r=n.oxw(2);n.xp6(1),n.hij(" ",r.headers()[t].title," ")}}function pe(e,o){if(1&e&&(n.TgZ(0,"tr"),n.YNc(1,de,2,1,"th",1),n.qZA()),2&e){const t=n.oxw();n.xp6(1),n.Q6J("ngForOf",t.columnKeys())}}function fe(e,o){if(1&e&&(n.TgZ(0,"div"),n._uU(1),n.qZA()),2&e){const t=n.oxw().$implicit,r=n.oxw().$implicit,i=n.oxw();n.xp6(1),n.hij(" ",i.tableCellOfString(r[t]).value," ")}}function me(e,o){if(1&e&&(n.TgZ(0,"div"),n._uU(1),n.ALo(2,"number"),n.qZA()),2&e){const t=n.oxw().$implicit,r=n.oxw().$implicit,i=n.oxw();n.xp6(1),n.hij(" ",n.lcZ(2,1,i.tableCellOfNumber(r[t]).value)," ")}}function ge(e,o){if(1&e&&(n.TgZ(0,"div",3),n._UZ(1,"span",4),n.qZA()),2&e){const t=n.oxw().$implicit,r=n.oxw().$implicit,i=n.oxw();n.xp6(1),n.Udp("background-color",i.formatAsRgb(i.tableCellOfColorPreview(r[t]).rgb))}}function he(e,o){if(1&e&&(n.TgZ(0,"td"),n.YNc(1,fe,2,1,"div",0),n.YNc(2,me,3,3,"div",0),n.YNc(3,ge,2,2,"div",2),n.qZA()),2&e){const t=o.$implicit,r=n.oxw().$implicit,i=n.oxw();n.xp6(1),n.Q6J("ngIf",r[t].type===i.TableCellType.STRING),n.xp6(1),n.Q6J("ngIf",r[t].type===i.TableCellType.NUMBER),n.xp6(1),n.Q6J("ngIf",r[t].type===i.TableCellType.COLOR_PREVIEW)}}function Ce(e,o){if(1&e&&(n.TgZ(0,"tr"),n.YNc(1,he,4,3,"td",1),n.qZA()),2&e){const t=n.oxw();n.xp6(1),n.Q6J("ngForOf",t.columnKeys())}}function _e(e,o){if(1&e){const t=n.EpF();n.ynx(0),n.TgZ(1,"pal-pixel-color-picker",8),n.NdJ("onColorPick",function(i){n.CHM(t);const s=n.oxw();return n.KtG(s.colorPicked(i))}),n.qZA(),n._uU(2," \u753b\u50cf\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u8272\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044 "),n.BQk()}if(2&e){const t=n.oxw();n.xp6(1),n.Q6J("dataUrl",t.dataUrl())}}function be(e,o){1&e&&(n.TgZ(0,"div",9),n._uU(1," \u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044 "),n.qZA())}const A=e=>`rgb(${e.r},${e.g},${e.b})`;let ye=(()=>{class e{constructor(){this.onFileLoad=new n.vpe,this._reader=new FileReader}ngOnInit(){this._reader.onload=()=>{const t=this._reader.result;null!==t&&("string"==typeof t?this.onFileLoad.emit(t):console.log("ArrayBuffer data is not supported."))}}change(t){if(t.target instanceof HTMLInputElement){const r=t.target.files?.[0];if(void 0===r)return;this._reader.readAsDataURL(r)}}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=n.Xpm({type:e,selectors:[["pal-file-input-button"]],outputs:{onFileLoad:"onFileLoad"},standalone:!0,features:[n.jDz],ngContentSelectors:ce,decls:3,vars:0,consts:[["for","file-upload",1,"file-upload"],["id","file-upload","type","file",2,"display","none",3,"change"]],template:function(r,i){1&r&&(n.F$t(),n.TgZ(0,"label",0),n.Hsn(1),n.qZA(),n.TgZ(2,"input",1),n.NdJ("change",function(a){return i.change(a)}),n.qZA())},dependencies:[c.ez],styles:[".file-upload[_ngcontent-%COMP%]{border:1px solid #ccc;display:inline-block;padding:6px 12px;cursor:pointer;background-color:#f8f8f8;border-radius:4px}.file-upload[_ngcontent-%COMP%]:hover{background-color:#e8e8e8}"]})}return e})(),Me=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=n.Xpm({type:e,selectors:[["pal-pick-mark"]],standalone:!0,features:[n.jDz],decls:2,vars:0,consts:[[1,"material-symbols-outlined"]],template:function(r,i){1&r&&(n.TgZ(0,"span",0),n._uU(1,"highlight_mouse_cursor"),n.qZA())},dependencies:[c.ez]})}return e})(),Pe=(()=>{class e{constructor(){this.onColorPick=new n.vpe,this.position=(0,n.tdS)({top:"0",left:"0"}),this._img=new Image}ngOnInit(){this._img.onload=()=>{if(void 0===this._canvasContext)return;const t=400/this._img.height,r=400/this._img.width,i=t<r?t:r,s=this._img.width*i,a=this._img.height*i;this._canvasContext.canvas.width=s,this._canvasContext.canvas.height=a,this._canvasContext.drawImage(this._img,0,0,s,a)}}ngOnChanges(){this._img.src=this.dataUrl}ngAfterViewInit(){this._canvasContext=this._canvasElement.nativeElement.getContext("2d",{willReadFrequently:!0})}pick(t){this.position.set({top:t.offsetY-10+"px",left:t.offsetX-10+"px"});const r=this._canvasContext?.getImageData(t.offsetX,t.offsetY,1,1);this.onColorPick.emit(r)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=n.Xpm({type:e,selectors:[["pal-pixel-color-picker"]],viewQuery:function(r,i){if(1&r&&n.Gf(ue,5),2&r){let s;n.iGM(s=n.CRH())&&(i._canvasElement=s.first)}},inputs:{dataUrl:"dataUrl"},outputs:{onColorPick:"onColorPick"},standalone:!0,features:[n.TTD,n.jDz],decls:3,vars:4,consts:[[1,"palette",3,"click"],["palette",""],[1,"pick-mark"]],template:function(r,i){1&r&&(n.TgZ(0,"canvas",0,1),n.NdJ("click",function(a){return i.pick(a)}),n.qZA(),n._UZ(2,"pal-pick-mark",2)),2&r&&(n.xp6(2),n.Udp("top",i.position().top)("left",i.position().left))},dependencies:[c.ez,Me],styles:["[_nghost-%COMP%]{position:relative;display:block}[_nghost-%COMP%]   .pick-mark[_ngcontent-%COMP%]{position:absolute;cursor:default}.palette[_ngcontent-%COMP%]{border:solid .1rem black;border-radius:.25rem}"]})}return e})();const d={STRING:"STRING",NUMBER:"NUMBER",COLOR_PREVIEW:"COLOR_PREVIEW"};function w(e,o,t,r){switch(e.type){case d.STRING:return o(e);case d.NUMBER:return t(e);case d.COLOR_PREVIEW:return r(e);default:throw new Error(e)}}let we=(()=>{class e{constructor(){this.headers=(0,n.tdS)(void 0),this.rows=(0,n.tdS)([]),this.columnKeys=(0,n.Flj)(()=>Object.keys(this.headers()??{})),this.TableCellType=d,this.formatAsRgb=A,this.tableCellOfString=Te,this.tableCellOfNumber=xe,this.tableCellOfColorPreview=Oe}ngOnChanges(){this.headers.set(this.dataSource.headers),this.rows.set(this.dataSource.rows)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=n.Xpm({type:e,selectors:[["pal-table"]],inputs:{dataSource:"dataSource"},standalone:!0,features:[n.TTD,n.jDz],decls:5,vars:2,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],["class","color-preview",4,"ngIf"],[1,"color-preview"],[1,"color-preview-inner"]],template:function(r,i){1&r&&(n.TgZ(0,"table")(1,"thead"),n.YNc(2,pe,2,1,"tr",0),n.qZA(),n.TgZ(3,"tbody"),n.YNc(4,Ce,2,1,"tr",1),n.qZA()()),2&r&&(n.xp6(2),n.Q6J("ngIf",void 0!==i.headers()),n.xp6(2),n.Q6J("ngForOf",i.rows()))},dependencies:[c.ez,c.sg,c.O5,c.JJ],styles:["table[_ngcontent-%COMP%]{border-collapse:collapse;margin:25px 0;font-size:.9em;min-width:400px;width:100%;box-shadow:0 0 20px #00000026}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#009879;color:#fff;text-align:left;border-bottom:2px solid #dddddd}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;border:1px solid #dddddd}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #dddddd}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-of-type(2n){background-color:#f3f3f3}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-of-type{border-bottom:2px solid #009879}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.color-preview[_ngcontent-%COMP%]{display:flex;justify-content:center}.color-preview-inner[_ngcontent-%COMP%]{display:inline-block;width:1rem;height:1rem;border:solid .1rem black;border-radius:.3rem}"]})}return e})();function Te(e){return w(e,o=>o,()=>{throw new Error},()=>{throw new Error})}function xe(e){return w(e,()=>{throw new Error},o=>o,()=>{throw new Error})}function Oe(e){return w(e,()=>{throw new Error},()=>{throw new Error},o=>o)}let Re=(()=>{class e{constructor(){this.onColorPick=new n.vpe,this.dataUrl=(0,n.tdS)(void 0),this.selectedColor=(0,n.tdS)("")}fileLoaded(t){this.dataUrl.set(t)}colorPicked(t){const r=(e=>({r:e.data[0],g:e.data[1],b:e.data[2]}))(t);this.selectedColor.set(A(r)),this.onColorPick.emit(r)}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=n.Xpm({type:e,selectors:[["pal-color-picker-page-template"]],outputs:{onColorPick:"onColorPick"},standalone:!0,features:[n.jDz],decls:11,vars:5,consts:[[1,"left"],[4,"ngIf","ngIfElse"],["noData",""],[1,"right"],[3,"onFileLoad"],[1,"selected-color"],[1,"color-block"],[1,"color-text"],[3,"dataUrl","onColorPick"],[1,"no-data-text"]],template:function(r,i){if(1&r&&(n.TgZ(0,"div",0),n.YNc(1,_e,3,1,"ng-container",1),n.YNc(2,be,2,0,"ng-template",null,2,n.W1O),n.qZA(),n.TgZ(4,"div",3)(5,"pal-file-input-button",4),n.NdJ("onFileLoad",function(a){return i.fileLoaded(a)}),n._uU(6," \u30a2\u30c3\u30d7\u30ed\u30fc\u30c9 "),n.qZA(),n.TgZ(7,"div",5),n._UZ(8,"span",6),n.TgZ(9,"span",7),n._uU(10),n.qZA()()()),2&r){const s=n.MAs(3);n.xp6(1),n.Q6J("ngIf",void 0!==i.dataUrl())("ngIfElse",s),n.xp6(7),n.Udp("background-color",i.selectedColor()),n.xp6(2),n.hij(" ",i.selectedColor()," ")}},dependencies:[c.ez,c.O5,ye,Pe],styles:["[_nghost-%COMP%]{display:flex}.left[_ngcontent-%COMP%], .right[_ngcontent-%COMP%]{padding:8px}.right[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.selected-color[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.selected-color[_ngcontent-%COMP%]   .color-block[_ngcontent-%COMP%]{display:inline-block;width:1rem;height:1rem;border:solid .1rem black;border-radius:.3rem}.no-data-text[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:1em;width:400px;height:400px;border:solid .1rem black;border-radius:.3rem}"]})}return e})();const ke={headers:{name:{title:"Name"},rgb:{title:"RGB"},colorPreview:{title:"ColorPreview"},diff:{title:"Diff"}},rows:[]};let Ne=(()=>{class e{constructor(){this.dataSource=ke}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=n.Xpm({type:e,selectors:[["pal-paint-table-page-template"]],inputs:{dataSource:"dataSource"},standalone:!0,features:[n.jDz],decls:1,vars:1,consts:[[3,"dataSource"]],template:function(r,i){1&r&&n._UZ(0,"pal-table",0),2&r&&n.Q6J("dataSource",i.dataSource)},dependencies:[c.ez,we]})}return e})();var Ie=u(862),_=u(398);function T(e,o){o=F(o||{R:255,G:255,B:255});let t=e=F(e);return void 0!==e.A&&(t={R:o.R+(e.R-o.R)*e.A,G:o.G+(e.G-o.G)*e.A,B:o.B+(e.B-o.B)*e.A}),function Se(e){let i=e.Y/100,s=e.Z/108.883,a=e.X/95.047;return a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,{L:116*i-16,a:500*(a-i),b:200*(i-s)}}(function Ee(e){let o=e.R/255,t=e.G/255,r=e.B/255;o>.04045?o=Math.pow((o+.055)/1.055,2.4):o/=12.92,t>.04045?t=Math.pow((t+.055)/1.055,2.4):t/=12.92,r>.04045?r=Math.pow((r+.055)/1.055,2.4):r/=12.92,o*=100,t*=100,r*=100;return{X:.4124*o+.3576*t+.1805*r,Y:.2126*o+.7152*t+.0722*r,Z:.0193*o+.1192*t+.9505*r}}(t))}function F(e){let o,t,r,i;"R"in e?(o=e.R,t=e.G,r=e.B,i=e.A):(o=e.r,t=e.g,r=e.b,i=e.a);const s={R:o,G:t,B:r};return void 0!==i&&(s.A=i),s}function De(e,o,t){("R"in e||"r"in e)&&(e=T(e,t)),("R"in o||"r"in o)&&(o=T(o,t));const r=e.L,i=e.a,s=e.b,a=o.L,M=o.a,h=o.b,N=Math.sqrt(Math.pow(i,2)+Math.pow(s,2)),I=Math.sqrt(Math.pow(M,2)+Math.pow(h,2)),H=(N+I)/2,K=.5*(1-Math.sqrt(Math.pow(H,7)/(Math.pow(H,7)+Math.pow(25,7)))),ee=(1+K)*i,te=(1+K)*M,E=Math.sqrt(Math.pow(ee,2)+Math.pow(s,2)),S=Math.sqrt(Math.pow(te,2)+Math.pow(h,2)),ne=U(s,ee),oe=U(h,te),ft=a-r,re=S-E,mt=function Fe(e,o,t,r){if(e*o==0)return 0;if(Math.abs(r-t)<=180)return r-t;if(r-t>180)return r-t-360;if(r-t<-180)return r-t+360;throw new Error}(N,I,ne,oe),ie=2*Math.sqrt(E*S)*Math.sin(f(mt)/2),se=(r+a)/2,P=(E+S)/2,C=function Ue(e,o,t,r){if(e*o==0)return t+r;if(Math.abs(t-r)<=180)return(t+r)/2;if(Math.abs(t-r)>180&&t+r<360)return(t+r+360)/2;if(Math.abs(t-r)>180&&t+r>=360)return(t+r-360)/2;throw new Error}(N,I,ne,oe),gt=1-.17*Math.cos(f(C-30))+.24*Math.cos(f(2*C))+.32*Math.cos(f(3*C+6))-.2*Math.cos(f(4*C-63)),ht=30*Math.exp(-Math.pow((C-275)/25,2)),Ct=Math.sqrt(Math.pow(P,7)/(Math.pow(P,7)+Math.pow(25,7))),_t=1+.015*Math.pow(se-50,2)/Math.sqrt(20+Math.pow(se-50,2)),ae=1+.045*P,le=1+.015*P*gt,bt=-2*Ct*Math.sin(f(2*ht));return Math.sqrt(Math.pow(ft/(1*_t),2)+Math.pow(re/(1*ae),2)+Math.pow(ie/(1*le),2)+bt*(re/(1*ae))*(ie/(1*le)))}function f(e){return e*(Math.PI/180)}function U(e,o){if(0===e&&0===o)return 0;{const t=function Ae(e){return e*(180/Math.PI)}(Math.atan2(e,o));return t>=0?t:t+360}}function L(e){return T(e)}let qe=(()=>{class e{constructor(){this.baseUrl="https://kyohei-norita.github.io/palettea-web/",this._http=(0,n.f3M)(Ie.eN)}closestPaintTable(t){const r={R:t.r,G:t.g,B:t.b};return this._http.get(`${this.baseUrl}assets/paint-data.json`).pipe((0,_.U)(i=>i),(0,_.U)(i=>i.map(s=>((e,o)=>({id:o.id,name:o.name,rgb:{r:o.rgb.R,g:o.rgb.G,b:o.rgb.B},difference:De(L(e),L(o.rgb))}))(r,s))),(0,_.U)(i=>i.sort((s,a)=>s.difference-a.difference)),(0,_.U)(Ve))}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Ve=e=>({headers:{name:{title:"name"},rgb:{title:"rgb"},colorPreview:{title:"colorPreview"},diff:{title:"diff"}},rows:e.map(je)}),je=e=>({name:{type:d.STRING,value:e.name},rgb:{type:d.STRING,value:`rgb(${e.rgb.r},${e.rgb.g},${e.rgb.b})`},colorPreview:{type:d.COLOR_PREVIEW,rgb:e.rgb},diff:{type:d.NUMBER,value:e.difference}});var $e=u(645),ze=u(328),Ye=u(592),Je=u(773);function Z(e){e||((0,n.gHi)(Z),e=(0,n.f3M)(n.ktI));const o=new Ye.y(t=>e.onDestroy(t.next.bind(t)));return t=>t.pipe((0,Je.R)(o))}function dt(e,o){if(1&e&&n._UZ(0,"pal-paint-table-page-template",2),2&e){const t=n.oxw();n.Q6J("dataSource",t.closestPaintTable())}}const pt=[{path:"",component:(()=>{class e{constructor(){this._colorPickerPageService=(0,n.f3M)(qe),this._destroyRef=(0,n.f3M)(n.ktI),this.closestPaintTable=(0,n.tdS)(void 0),this.pickedRGB$=new $e.x}ngOnInit(){this.pickedRGB$.pipe(Z(this._destroyRef),(0,ze.b)(t=>this._colorPickerPageService.closestPaintTable(t))).subscribe(t=>this.closestPaintTable.set(t))}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275cmp=n.Xpm({type:e,selectors:[["pa-color-picker-page"]],standalone:!0,features:[n.jDz],decls:2,vars:1,consts:[[3,"onColorPick"],[3,"dataSource",4,"ngIf"],[3,"dataSource"]],template:function(r,i){1&r&&(n.TgZ(0,"pal-color-picker-page-template",0),n.NdJ("onColorPick",function(a){return i.pickedRGB$.next(a)}),n.qZA(),n.YNc(1,dt,1,1,"pal-paint-table-page-template",1)),2&r&&(n.xp6(1),n.Q6J("ngIf",void 0!==i.closestPaintTable()))},dependencies:[c.ez,c.O5,Re,Ne],encapsulation:2})}return e})()}]}}]);